<%# vim:set filetype=c: %>

#define STRINGIFY(x) #x

#define MACRO_ONE_PARAM compatible = "zmk,behavior-macro-one-param"; #binding-cells = <1>
#define MACRO_TWO_PARAM compatible = "zmk,behavior-macro-two-param"; #binding-cells = <2>

#define MOD_TAP_ONE_PARAM compatible = "zmk,behavior-hold-tap"; #binding-cells = <1>
#define MOD_TAP_TWO_PARAM compatible = "zmk,behavior-hold-tap"; #binding-cells = <2>

#define MACRO_WAIT_TAP_ZERO = wait-ms = <0>; tap-ms = <0>

#define UNICODE_LEAD_LINUX &macro_tap &kp LS(LC(U))
#define UNICODE_LEAD_OSX &macro_press &kp LALT

#define UNICODE_TRAIL_LINUX &macro_tap SPACE
#define UNICODE_TRAIL_OSX &macro_release LALT

#define HRM_HOLD (name) \
  ## name: ## name { \
    label = STRINGIFY(name); \
    STRINGIFY(MACRO_ONE_PARAM); \
    STRINGIFY(MACRO_WAIT_TAP_ZERO); \
    bindings \
      = <&macro_params_1to1> \
      , <&macro_press MACRO_PLACEHOLDER &mo STRINGIFY(LAYER_ ## name)> \
      , <&macro_pause_for_release> \
      , <&macro_params_1to1> \
      , <&macro_press MACRO_PLACEHOLDER &mo STRINGIFY(LAYER_ ## name)> \
      ; \
  } \

#define HRM_TAP (name) \
  ## name: ## name { \
    label = STRINGIFY(name); \
    STRINGIFY(MACRO_ONE_PARAM); \
    STRINGIFY(MACRO_WAIT_TAP_ZERO); \
    bindings \
      = <
          &macro_release
          &kp LSFT &kp RSFT
          &kp LALT &kp RALT
          &kp LCTL &kp RCTL
          &kp LGUI &kp LGUI
        >
      , <&macro_param_1to1>
      , <&macro_tap &kp MACRO_PLACEHOLDER>
      ;
  } \


